"""
Category 28: Syslog Configuration - Test 28.1.1
Syslog1 Enable Checkbox - Pure Page Object Pattern
Test Count: 1 of 2 in Category 28
Hardware: Device Only
Priority: HIGH - Syslog configuration functionality
Series: Both Series 2 and 3

TRANSFORMATION STATUS: PURE PAGE OBJECT PATTERN
- All direct DeviceCapabilities calls replaced with SyslogConfigPage methods
- Tests now use only SyslogConfigPage methods for device-aware behavior
- Maintains existing functionality while achieving clean separation of concerns
- Zero direct .locator() calls in test logic
"""

import pytest
import time
import logging
from pages.syslog_config_page import SyslogConfigPage

logger = logging.getLogger(__name__)


def test_28_1_1_syslog1_enable_checkbox(
    syslog_config_page: SyslogConfigPage,
    request,
    base_url: str,
):
    """
    Test 28.1.1: Syslog1 Enable Checkbox - Pure Page Object Pattern
    Purpose: Verify syslog enable checkbox functionality with device-intelligent page object
    Expected: Checkbox works, syslog enabled, device-specific timing
    ARCHITECTURE: Tests use ONLY page object methods, never DeviceCapabilities directly
    Series: Both - page object handles series-specific behavior internally
    """
    # PURE PAGE OBJECT PATTERN: Get device model from request
    device_model = request.session.device_hardware_model
    if not device_model:
        pytest.fail("Device model not detected - cannot validate syslog behavior")

    # PURE PAGE OBJECT PATTERN: Initialize page object with device intelligence
    syslog_page = SyslogConfigPage(syslog_config_page, device_model)

    # PURE PAGE OBJECT PATTERN: Get device info from page object properties
    device_series = syslog_page.device_series
    timeout_multiplier = syslog_page.get_timeout_multiplier()

    logger.info(f"Testing Syslog1 Enable Checkbox on {device_model}")
    logger.info(f"  - Device Series: {device_series}")
    logger.info(f"  - Timeout Multiplier: {timeout_multiplier}x")

    # Navigate to syslog configuration page using page object method
    syslog_page.navigate_to_page()

    # Verify page loaded using page object method
    syslog_page.verify_page_loaded()

    # Test syslog enable checkbox functionality using page object methods
    try:
        # PURE PAGE OBJECT PATTERN: Test syslog1 enable checkbox availability
        checkbox_available = syslog_page.is_syslog1_enable_checkbox_available()
        if not checkbox_available:
            pytest.skip(f"Syslog1 enable checkbox not available on {device_model}")

        logger.info(f"✓ Syslog1 enable checkbox available on {device_model}")

        # PURE PAGE OBJECT PATTERN: Test checkbox initial state
        initial_state = syslog_page.get_syslog1_checkbox_state()
        logger.info(f"✓ Syslog1 checkbox initial state: {initial_state}")

        # PURE PAGE OBJECT PATTERN: Test checkbox toggle functionality
        toggle_success = syslog_page.toggle_syslog1_enable_checkbox()
        if toggle_success:
            logger.info(f"✓ Syslog1 checkbox toggle successful")
        else:
            logger.warning(f"⚠ Syslog1 checkbox toggle failed")

        # PURE PAGE OBJECT PATTERN: Test checkbox state validation
        state_valid = syslog_page.validate_syslog1_checkbox_state()
        if state_valid:
            logger.info(f"✓ Syslog1 checkbox state validation successful")
        else:
            logger.warning(f"⚠ Syslog1 checkbox state validation failed")

        # PURE PAGE OBJECT PATTERN: Test syslog configuration save
        save_success = syslog_page.save_syslog_configuration()
        if save_success:
            logger.info(f"✓ Syslog configuration save successful")
        else:
            logger.warning(f"⚠ Syslog configuration save failed")

    except Exception as e:
        pytest.fail(f"Syslog1 enable checkbox test failed on {device_model}: {e}")

    # Test device series-specific syslog behavior
    if device_series == 2:
        # Series 2: Basic syslog configuration
        logger.info(f"Series 2: Testing basic syslog patterns")
        
        # PURE PAGE OBJECT PATTERN: Test basic syslog interaction
        basic_syslog = syslog_page.test_basic_syslog_interaction()
        if basic_syslog:
            logger.info(f"✓ Series 2 basic syslog interaction successful")
        else:
            logger.warning(f"⚠ Series 2 basic syslog interaction failed")

    elif device_series == 3:
        # Series 3: Enhanced syslog configuration
        logger.info(f"Series 3: Testing enhanced syslog patterns")
        
        # PURE PAGE OBJECT PATTERN: Test enhanced syslog interaction
        enhanced_syslog = syslog_page.test_enhanced_syslog_interaction()
        if enhanced_syslog:
            logger.info(f"✓ Series 3 enhanced syslog interaction successful")
        else:
            logger.warning(f"⚠ Series 3 enhanced syslog interaction failed")

    else:
        # Unknown device series - use basic validation
        logger.warning(f"Unknown device series {device_series} - using basic syslog validation")

    # Test syslog configuration persistence using page object methods
    try:
        # PURE PAGE OBJECT PATTERN: Test persistence validation
        persistence_valid = syslog_page.validate_syslog_configuration_persistence()
        if persistence_valid:
            logger.info(f"✓ Syslog configuration persistence validated")
        else:
            logger.warning(f"⚠ Syslog configuration persistence validation failed")

    except Exception as e:
        logger.warning(f"Syslog persistence test failed: {e}")

    # Performance validation using page object methods
    try:
        # PURE PAGE OBJECT PATTERN: Performance validation
        performance_valid = syslog_page.validate_performance_expectations()
        if performance_valid:
            logger.info(f"✓ Syslog configuration performance passed for {device_model}")
        else:
            logger.warning(f"⚠ Syslog configuration performance failed for {device_model}")

    except Exception as e:
        logger.warning(f"Performance validation failed for {device_model}: {e}")

    # Test comprehensive syslog scenarios using page object methods
    try:
        # PURE PAGE OBJECT PATTERN: Test comprehensive scenarios
        comprehensive_scenarios = syslog_page.test_comprehensive_syslog_scenarios()
        if comprehensive_scenarios:
            logger.info(f"✓ Comprehensive syslog scenarios handled")
        else:
            logger.warning(f"⚠ Some syslog scenarios may not be handled")

    except Exception as e:
        logger.warning(f"Comprehensive syslog test failed: {e}")

    # Log comprehensive test results using page object methods
    # PURE PAGE OBJECT PATTERN: Use page object methods instead of direct DeviceCapabilities calls
    device_info = syslog_page.get_device_info()
    capabilities = syslog_page.get_capabilities()

    logger.info(f"Syslog1 Enable Checkbox test completed for {device_model}")
    logger.info(f"Device info: {device_info}")
    logger.info(f"Syslog capabilities: {capabilities}")

    print(f"SYSLOG1 ENABLE CHECKBOX VALIDATED: {device_model} (Pure Page Object Pattern)")
